%Multi-class to train the hand-written digit
X=zeros(5,5,5);
X(:,:,1)=[0,1,1,0,0;
    0,0,1,0,0;
    0,0,1,0,1;
    0,0,1,0,0;
    0,1,1,1,0];
X(:,:,2)=[1,1,1,1,0;
    0,0,0,0,1;
    0,1,1,1,0;
    1,0,0,0,0;
    1,1,1,1,1];
X(:,:,3)=[1,1,1,1,0;
    0,0,0,0,1;
    0,1,1,1,0;
    0,0,0,0,1;
    1,1,1,1,1];
X(:,:,4)=[0,0,0,1,0;
    0,0,1,1,0;
    0,1,0,1,0;
    1,1,1,1,1;
    0,0,0,1,0];
X(:,:,5)=[1,1,1,1,1;
    1,0,0,0,0;
    1,1,1,1,0;
    0,0,0,0,1;
    1,1,1,1,0];
D=[1,0,0,0,0;
    0,1,0,0,0;
    0,0,1,0,0;
    0,0,0,1,0;
    0,0,0,0,1];
W1=2*rand(50,25)-1;
W2=2*rand(5,50)-1;
for epoch=1:10000
    [W1,W2]=Multi_class(X,D,W1,W2);
end
X_test=zeros(5,5,5);
X_test(:,:,1)=[0 0 1 1 0;
    0 0 1 1 0;
    0 1 0 1 0;
    0 0 0 1 0;
    0 1 1 1 0];
X_test(:,:,2)=[1 1 1 1 0;
    0 0 0 0 1;
    0 1 1 1 0;
    1 0 0 0 1;
    1 1 1 1 1];
X_test(:,:,3)=[1 1 1 1 0;
    0 0 0 0 1;
    0 1 1 1 0;
    1 0 0 0 1;
    1 1 1 1 0];
X_test(:,:,4)=[0,1,1,1,0;
    0,1,0,0,0;
    0,1,1,1,0;
    0,0,0,1,0;
    0,1,1,1,0];
X_test(:,:,5)=[0,1,1,1,1;
    0,1,0,0,0;
    0,1,1,1,0;
    0,0,0,1,0;
    1,1,1,1,0];


for k=1:5
    x=reshape(X_test(:,:,k),25,1);
    v1=W1*x;
    y1=sigmoid(v1);
    v2=W2*y1;
    y2=softmax(v2)
end

